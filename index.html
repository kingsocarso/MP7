<!DOCTYPE html>
<html>
  <head>
    <style>
       #map {
        height: 600px;
        width: 800px;
        margin-left: auto;
        margin-right: auto;
       }
       #boxed {
	        width: auto;
          height: auto;

          margin-left: auto;
          margin-right: auto;
          margin-top:auto;
          margin-bottom:auto;
          overflow: auto;
	        padding: 30px;
	        border: 2px solid #200a82;
	        margin: 25;
	        background-color: #80f0f2
	    }
    </style>
    <script>
    window.onload = function () {
      var chart = new CanvasJS.Chart("chartContainer", {
	       animationEnabled: true,

	       title:{
		          text:"Number of NRHP-listed Sites by County"
	       },
	            axisX:{
		             interval: 1
              },
              axisY2:{
		interlacedColor: "rgba(1,77,101,.2)",
		gridColor: "rgba(1,77,101,.1)",
		title: "Number of Sites"
	},
	data: [{
		type: "bar",
		name: "companies",
		axisYType: "secondary",
		color: "#014D65",
		dataPoints: [
			{ y: 64, label: "Sangamon" },
			{ y: 58, label: "Champaign" },
			{ y: 43, label: "Fulton" },
			{ y: 34, label: "Peoria" },
			{ y: 33, label: "McLean" },
			{ y: 27, label: "Adams" },
			{ y: 21, label: "Coles" },
			{ y: 19, label: "Jersey" },
			{ y: 17, label: "Tazewell" },
			{ y: 14, label: "Pike" },
			{ y: 13, label: "Livingston" },
			{ y: 13, label: "Montgomery" },
			{ y: 13, label: "Vermilion" },
			{ y: 12, label: "Greene" },
			{ y: 12, label: "Hancock" },
			{ y: 12, label: "Logan" },
			{ y: 10, label: "Macon" },
			{ y: 10, label: "Warren" }
      { y: 9, label: "Clark" }
      { y: 9, label: "Morgan" }
      { y: 8, label: "Edgar" }
      { y: 8, label: "Macoupin" }
      { y: 8, label: "McDonough" }
      { y: 8, label: "Woodford" }
      { y: 7, label: "Calhoun" }
      { y: 7, label: "Knox" }
      { y: 6, label: "Christian" }
      { y: 6, label: "Piatt" }
      { y: 6, label: "Shelby" }
      { y: 5, label: "Ford" }
      { y: 5, label: "Iroquois" }
      { y: 5, label: "Menard" }
      { y: 4, label: "Henderson" }
      { y: 4, label: "Mason" }
      { y: 3, label: "Cumberland" }
      { y: 2, label: "Brown" }
      { y: 2, label: "Cass" }
      { y: 2, label: "DeWitt" }
      { y: 2, label: "Douglas" }
      { y: 2, label: "Marshall" }
      { y: 2, label: "Schuyler" }
      { y: 2, label: "Scott" }
      { y: 1, label: "Edwards" }
      { y: 1, label: "Moultrie" }
      { y: 1, label: "Stark" }
		]
	}]
});
chart.render();

}
</script>
  </head>
  <body>
    <h2 style="text-align: center; font-family: Verdana, sans-serif; font-size: 46px;">MP7:</h2>
    <h3 style="text-align: center; font-family: Georgia, serif; font-size: xx-large;">Mapping Central Illinois historic sites</h3>
    <p style="text-align: center; font-family: Century Gothic, sans-serif;">
      There are <b>45</b> counties in <b>Central Illinois</b>. This is a large geographical region with a varied, distinct culture and history. So, we can learn more about this culture by analyzing its historical landmarks. Below is a map documenting the <b>463</b> properties in Central Illinois listed in the <b>National Register of Historic Places</b> along with some basic information. Note that there is a limit as to how much data Google Maps can process at once, so please use the buttons underneath the map to view in-depth datasets. (Data is from 06/01/2007)
    </p>
    <script src="//code.jquery.com/jquery-1.10.2.js"></script>
    <div id="map"></div>
    <div id="boxed">
      <button onclick="clearOverlays(); url = 'central_illinois.geojson'; initMap();" id="1" style="padding:10px; cursor:pointer; margin-left: auto; margin-right: auto; background-color: lightgrey; border: 2px solid #070707;margin: 5px 5px 5px 5px ;" >Display all sites in Central Illinois</button>
      <button onclick="clearOverlays(); url = 'western_central_illinois.geojson'; initMap();" id="2" style="padding:10px; cursor:pointer; margin-left: auto; margin-right: auto; background-color: lightgrey; border: 2px solid #070707;margin: 5px 5px 5px 5px ;">Display sites in Western Central Illinois</button>
      <button onclick="clearOverlays(); url = 'eastern_central_illinois.geojson'; initMap();" id="3" style="padding:10px; cursor:pointer; margin-left: auto; margin-right: auto; background-color: lightgrey; border: 2px solid #070707;margin: 5px 5px 5px 5px ;">Display sites in Eastern Central Illinois</button>
    </div>
    <div id="chartContainer" style="height: 370px; width: 100%;"></div>
    <script>
    var map
    var markers = []
    var url = 'central_illinois.geojson'

    function loadMarkers() {
      console.log('creating markers')
      var infoWindow = new google.maps.InfoWindow()
      map.data.forEach(function(feature) {

        var latitude = feature.getGeometry().get().lat()
        var longitude = feature.getGeometry().get().lng()
        var titleText = feature.getProperty('Name')
        var descriptionText = feature.getProperty('description')

        var marker = new google.maps.Marker({
          position: {lat: latitude, lng:longitude},
          title: titleText,
          map: map
         });

        var markerInfo = "<div><h3>" + titleText + "</h3>" + descriptionText + "</div>"

        marker.addListener('click', function() {
              infoWindow.close()
              infoWindow.setContent(markerInfo)
              infoWindow.open(map, marker)
            });
        markers.push(marker)
      });
    }
      function initMap() {
        var centIllinois = {lat: 40.15, lng: -89.5};
        map_options = {
          zoom: 8,
          mapTypeId: google.maps.MapTypeId.HYBRID,
          center: centIllinois
        }

        map_document = document.getElementById('map')
        map = new google.maps.Map(map_document,map_options);
        console.log('loading geojson')
        map.data.loadGeoJson(url, null, loadMarkers)
      }
	function setMapOnAll(map) {
        for (var i = 0; i < markers.length; i++) {
          markers[i].setMap(map);
        }
      }

      function clearOverlays() {

        setMapOnAll(null);
        markers = [];
      }
    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCZ5Kx-fbPez0aSmRcIWi0p4CGtGzteQoo&callback=initMap">
    </script>


  </body>
</html>
